all: spaceava.iso

HUC_ROOT = /mnt/c/Users/nicol/apps/huc

CC = PCE_INCLUDE=$(HUC_ROOT)/include/pce PCE_PCEAS=$(HUC_ROOT)/bin/pceas $(HUC_ROOT)/bin/huc
ISOLINK = $(HUC_ROOT)/bin/isolink

SRC = spaceava.c

CFLAGS ?= -fno-recursive -msmall
CDFLAGS = -scd -over

spaceava.iso: %.ovl cuefile
	$(ISOLINK) ../build/spaceava.iso ../build/*.ovl

%.ovl: $(SRC)
	$(CC) $(CFLAGS) $(CDFLAGS) $(SRC) $(LIBS)
	mv *.s *.ovl *.sym ../build

cuefile: spaceava.cue
	cp spaceava.cue ../build/

pce: $(SRC)
	$(CC) $(CFLAGS) $(SRC) $(LIBS)

clean:
	rm -f ../build/*
